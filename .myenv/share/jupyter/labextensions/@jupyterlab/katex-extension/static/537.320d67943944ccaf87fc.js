"use strict";(self.webpackChunk_jupyterlab_katex_extension=self.webpackChunk_jupyterlab_katex_extension||[]).push([[537],{9537:(e,t,n)=>{n.r(t),n.d(t,{KatexTypesetter:()=>y,default:()=>g});var a=n(1486),r=n(6629),i=n(8509),o=n.n(i);function l(e,t,n){let a=n,r=0;const i=e.length;for(;a<t.length;){const n=t[a];if(r<=0&&t.slice(a,a+i)===e)return a;"\\"===n?a++:"{"===n?r++:"}"===n&&r--,a++}return-1}function s(e,t,n,a){const r=[];for(let i=0;i<e.length;i++)if("text"===e[i].type){const o=e[i].data;let s,d=!0,c=0;for(s=o.indexOf(t),-1!==s&&(c=s,r.push({type:"text",data:o.slice(0,c),display:a}),d=!1);;){if(d){if(s=o.indexOf(t,c),-1===s)break;r.push({type:"text",data:o.slice(c,s),display:a}),c=s}else{if(s=l(n,o,c+t.length),-1===s)break;r.push({type:"math",data:o.slice(c+t.length,s),rawData:o.slice(c,s+n.length),display:a}),c=s+n.length}d=!d}r.push({type:"text",data:o.slice(c),display:a})}else r.push(e[i]);return r}function d(e,t){var n;const a=function(e,t){let n=[{type:"text",data:e,display:!1}];for(let e=0;e<t.length;e++){const a=t[e];n=s(n,a.left,a.right,a.display||!1)}return n}(e,t.delimiters),r=document.createDocumentFragment();for(let e=0;e<a.length;e++)if("text"===a[e].type)r.appendChild(document.createTextNode(a[e].data));else{const i=document.createElement("span"),l=a[e].data;t.displayMode=a[e].display;try{o().render(l,i,t)}catch(t){console.error(`Failed to render mathematical expression with Katex:\n${t}`),r.appendChild(document.createTextNode(null!==(n=a[e].rawData)&&void 0!==n?n:""));continue}r.appendChild(i)}return r}function c(e,t){var n;for(let a=0;a<e.childNodes.length;a++){const r=e.childNodes[a];if(3===r.nodeType){const i=d(null!==(n=r.textContent)&&void 0!==n?n:"",t);a+=i.childNodes.length-1,e.replaceChild(i,r)}else 1===r.nodeType&&-1===t.ignoredTags.indexOf(r.nodeName.toLowerCase())&&c(r,t)}}const p={delimiters:[{left:"$$",right:"$$",display:!0},{left:"\\[",right:"\\]",display:!0},{left:"\\(",right:"\\)",display:!1},{left:"$",right:"$",display:!1},{left:"\\begin{equation}",right:"\\end{equation}",display:!0}],ignoredTags:["script","noscript","style","textarea","pre","code"],errorColor:"#CC0000",throwOnError:!1};function h(e,t={}){if(!e)throw new Error("No element provided to render");c(e,{...p,...t})}const u="@jupyterlab/katex-extension:plugin",f={};class y{typeset(e){h(e,f)}}const g={id:u,requires:[r.ISettingRegistry],provides:a.ILatexTypesetter,activate:(e,t)=>{function n(e){const t=e.get("macros").composite;f.macros=t}return t.load(u).then((e=>{e.changed.connect(n),n(e)})).catch((e=>{console.error(e.message)})),new y},autoStart:!0}}}]);